{"version":3,"sources":["config/config.js","views/Editor/actions.js","views/Editor/reducer.js","views/Reader/actions.js","views/Reader/reducer.js","components/Audio/actions.js","components/Audio/reducer.js","components/Menu/actions.js","components/Menu/reducer.js","components/Dictionary/actions.js","components/Dictionary/reducer.js","configureStore.js","components/Menu/index.js","App.js","serviceWorker.js","views/Home/index.js","components/Audio/index.js","views/Editor/index.js","components/Dictionary/index.js","views/Reader/index.js","index.js"],"names":["siteurl","GLOBAL","OFFINE","API_LOGIN_URL","API_POST_URL","apiurl","API_AUDIO_URL","API_MENU_URL","API_DICTIONARY_URL","isAdmin","fetch","method","then","result","json","token","catch","error","alert","receive_post","post","type","getPosts","state","items","combineReducers","action","_","unionBy","isArray","fetchPost","params","dispatch","config","postId","headers","response","receive_references","references","getReferences","isFetching","status","Object","assign","receive_audio","list","fetchAudioList","Authorization","setted_audio","reference","getAudioList","getReference","isSettingReference","isSetting","receive_category","posts","receive_meaning","meaning","receive_traduction","traduction","getMeaning","getTraduction","fetchingMeaning","isFetchingMeaning","fetchingTraduction","isFetchingTraduction","rootPersistConfig","key","storage","blacklist","debug","rootReducer","persistCombineReducers","persistReducer","OFFLINE","reader","audio","category","dictionary","history","createBrowserHistory","store","createStore","window","__REDUX_DEVTOOLS_EXTENSION__","undefined","applyMiddleware","thunk","routerMiddleware","persistStore","Navigation","props","parentWidth","expanded","activeKey","handleExpandSide","bind","handleSelect","this","setState","ReactDOM","findDOMNode","parentNode","clientWidth","that","debouncedHandleResize","fn","ms","timer","clearTimeout","setTimeout","apply","arguments","debounce","addEventListener","categorySlug","fetchCategory","String","viewPorts","sm","Sidenav","appearance","className","defaultOpenKeys","onSelect","Body","Navbar","Nav","Item","onClick","eventKey","style","height","icon","Icon","size","componentClass","to","Dropdown","title","href","Divider","Header","DropdownCategory","React","Component","isEmpty","descriptionList","forEach","find","tags","tag","name","cap","split","engPost","itaPost","lang","p","getPost","subCategoryName","sub_category","push","display","ID","post_title","chapter","description","parts","partName","Menu","reverse","divider","connect","xs","md","lg","App","loading","delay","Container","FlexboxGrid","justify","Col","xl","Content","children","Footer","defaultProps","withRouter","Boolean","location","hostname","match","Home","Panel","textAlign","borderRadius","src","alt","dangerouslySetInnerHTML","__html","List","header","id","AudioList","currentPlay","currentPlayIndex","firstIndex","lastActionTime","Date","now","prevAction","selectAudio","prevProps","prevState","Number","keys","getAudioId","console","log","index","length","document","getElementById","play","isPlaylistEnded","previousPlay","item","getIdFromFilename","refresh","audioList","selected","componentList","prevTrack","nextTrack","Notification","showAlsoUnassigned","filter","post_parent","playingNameId","isPlaying","form","FormData","append","body","setOrUpdateAudio","isUndefined","map","fileNameId","hide","active","handleClick","Audio","controls","source","Selectors","data","counter","subCounter","classes","Editor","audioSelected","canAttach","allAudio","actionList","oldSelected","handleSelectAudio","componentDidMount","trigger","pop","e","currentTarget","isNil","content","rendered","replace","Button","color","flexDirection","Toggle","onChange","selectionChanged","insertNextNplay","Dictionary","close","show","word","fetchMeaning","fetchTraduction","Drawer","onHide","Title","Loader","DefinitionList","def","AudioWord","uk","us","hover","ele","i","width","lastcall","Reader","postIta","postEng","selectedReference","selectedPiece","wordSelected","showTraduction","playOnClick","playAll","playIndex","hideTraduction","fetchData","fetchReferences","scroll","top","left","behavior","referencesInserted","getSelectionId","classList","add","textAligned","itaP","querySelectorAll","val","position","offsetTop","referencesList","sortBy","tooEarly","insertReferencesIntoText","alignText","current","remove","contains","updateSelection","onlyWord","innerHTML","onEnd","ref","selectionId","Howl","autoplay","preload","on","stopPlay","handleEnd","findIndex","itaContent","ButtonToolbar","alignItems","IconButton","disabled","checkedChildren","unCheckedChildren","checked","vertical","fetching","render","StrictMode","exact","path","component","navigator","serviceWorker","ready","registration","unregister","message"],"mappings":"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","file":"static/js/main.61eaa01b.chunk.js","sourcesContent":["import 'whatwg-fetch';\n\n//const siteurl = 'http://wptest.me'\nconst siteurl = 'http://treasureisland.local'\n\nlet apiurl = siteurl + '/wp-json/wp/v2/';\nlet login = siteurl + '/wp-json/jwt-auth/v1/token';\nvar GLOBAL = {\n\tOFFINE: false,\n\tAPI_LOGIN_URL: login,\n\tAPI_POST_URL: apiurl + 'posts',\n  API_AUDIO_URL: siteurl + '/wp-json/audio/',\n  API_MENU_URL: siteurl  + '/wp-json/menu/',\n  API_DICTIONARY_URL: siteurl + '/wp-json/dictionary/',\n\tisAdmin:false\n}\n\nfetch(`${GLOBAL.API_LOGIN_URL}?username=demo&password=demo`,\n  {\n    method: 'POST'\n  })\n  .then( result => result.json() )\n  .then( json => GLOBAL.token = json.token )\n  .catch( error => alert('Login error'))\n\nexport default GLOBAL","import 'whatwg-fetch';\nimport config from '../../config/config'\n\nexport const REQUEST_POST = 'REQUEST_POST';\nexport const RECEIVE_POST = 'RECEIVE_POST';\n\nconst request_post = () => {\n  return {\n    type: REQUEST_POST\n  }\n}\n\nconst receive_post = (post) => {\n  return {\n    type: RECEIVE_POST,\n    post\n  }\n}\n\nexport const fetchPost = (params = {}) => (dispatch) => {\n  dispatch(request_post())\n\n  return fetch(config.API_POST_URL + '/' + (params.postId || ''), {\n    headers: {'Authorization': 'Bearer '+ config.token }\n  })\n    .then( response => response.json() )\n    .then( json => dispatch(receive_post(json)) )\n    .catch( (error) => dispatch(receive_post([])) )\n}","import { combineReducers } from 'redux';\nimport { REQUEST_POST, RECEIVE_POST } from './actions'\nimport _ from 'lodash'\n\nconst items = (state = [], action) => {\n  switch(action.type) {\n    case REQUEST_POST:\n      return state;\n    case RECEIVE_POST:\n      return _.unionBy( _.isArray(action.post) ? action.post : [action.post], state, 'id') // rimuove doppioni\n    default:\n      return state;\n  }\n}\n\nexport const getPosts = state => state.items \n\nexport default combineReducers({\n  items\n})","import 'whatwg-fetch';\nimport config from '../../config/config'\n\nexport const REQUEST_POST = 'REQUEST_POST';\nexport const RECEIVE_POST = 'RECEIVE_POST';\n\nconst request_post = () => {\n  return {\n    type: REQUEST_POST\n  }\n}\n\nconst receive_post = (post) => {\n  return {\n    type: RECEIVE_POST,\n    post\n  }\n}\n\nexport const fetchPost = (params = {}) => (dispatch) => {\n  dispatch(request_post())\n\n  return fetch(config.API_POST_URL + '/' + (params.postId || ''), {\n    headers: {'Authorization': 'Bearer '+ config.token }\n  })\n    .then( response => response.json() )\n    .then( json => dispatch(receive_post(json)) )\n    .catch( (error) => dispatch(receive_post([])) )\n}\n\nexport const REQUEST_REFERENCES = 'REQUEST_REFERENCES';\nexport const RECEIVE_REFERENCES = 'RECEIVE_REFERENCES';\n\nconst request_references = () => {\n  return {\n    type: REQUEST_REFERENCES\n  }\n}\n\nconst receive_references = (references) => {\n  return {\n    type: RECEIVE_REFERENCES,\n    references\n  }\n}\n\nexport const fetchReferences = (params = {}) => (dispatch) => {\n  dispatch(request_references())\n\n  return fetch(config.API_AUDIO_URL + 'references?post_id=' + (params.postId || ''), {\n    headers: {'Authorization': 'Bearer '+ config.token }\n  })\n    .then( response => response.json() )\n    .then( json => dispatch(receive_references(json)) )\n    .catch( (error) => dispatch(receive_references([])) )\n}","import { combineReducers } from 'redux';\nimport { \n  REQUEST_POST, RECEIVE_POST,\n  REQUEST_REFERENCES, RECEIVE_REFERENCES\n} from './actions'\nimport _ from 'lodash'\n\nconst items = (state = [], action) => {\n  switch(action.type) {\n    case REQUEST_POST:\n      return state;\n    case RECEIVE_POST:\n      return _.unionBy( _.isArray(action.post) ? action.post : [action.post], state, 'id') // rimuove doppioni\n    default:\n      return state;\n  }\n}\n\nconst references = (state = [], action) => {\n  switch(action.type) {\n    case REQUEST_REFERENCES:\n      return state;\n    case RECEIVE_REFERENCES:\n      return Object.assign(action.references, state) // rimuove doppioni\n    default:\n      return state;\n  }\n}\n\nconst status = (state = 0, action) => {\n  switch(action.type) {\n    case RECEIVE_REFERENCES:\n    case RECEIVE_POST:\n      return state-1;\n    case REQUEST_REFERENCES:\n    case REQUEST_POST:\n      return state+1;\n    default: \n      return state;\n  }\n}\n\nexport const getPosts = state => state.items \nexport const getReferences = state => state.references\nexport const isFetching = state => state.status > 0\n\nexport default combineReducers({\n  items,\n  references,\n  status\n})","import 'whatwg-fetch';\nimport config from '../../config/config';\nimport _ from 'lodash';\n\nexport const REQUEST_AUDIO = 'REQUEST_AUDIO';\nexport const RECEIVE_AUDIO = 'RECEIVE_AUDIO';\nexport const SET_AUDIO = 'SET_AUDIO';\nexport const SETTED_AUDIO = 'SETTED_AUDIO';\nexport const AUDIO_RESET = 'AUDIO_RESET';\n\nconst request_audio = () => {\n  return {\n    type: REQUEST_AUDIO\n  }\n}\n\nconst receive_audio = (list) => {\n  return {\n    type: RECEIVE_AUDIO,\n    list\n  }\n}\n\nexport const fetchAudioList = (params = {}) => (dispatch) => {\n  dispatch(request_audio())\n\n  //const showAlsoUnassigned = _.isUndefined(params.showAlsoUnassigned) ? '' : '&showAlsoUnassigned';\n  fetch(\n    config.API_AUDIO_URL + 'list?post_parent=' + params.postId + 'showAlsoUnassigned',\n    {\n      headers: {\n        Authorization: 'Bearer ' + config.token\n      }\n    }\n  )\n    .then( response => response.json())\n    .then( json => dispatch(receive_audio( json )))\n    .catch( error => dispatch(receive_audio([])))\n}\n\nconst set_audio = () => {\n  return {\n    type: SET_AUDIO\n  }\n}\n\nconst setted_audio = (result) => {\n  return {\n    type: SETTED_AUDIO,\n    reference: result.reference\n  }\n}\n\nexport const setOrUpdateAudio = (params = {}) => dispatch => {\n  dispatch(set_audio());\n\n  const form = new FormData();\n  form.append('post_id', params.id);\n  form.append('reference', params.reference);\n  form.append('post_parent', params.post_parent); // assign attachment to post ( eng )\n  fetch(\n    config.API_AUDIO_URL + 'set',\n    {\n      method: 'POST',\n      headers: {\n        Authorization: 'Bearer ' + config.token\n      },\n      body: form\n    }\n  )\n    .then( response => response.json() )\n    .then( json => dispatch(setted_audio(json)))\n    .catch( error => dispatch(setted_audio({})))\n}","import { \n  REQUEST_AUDIO, RECEIVE_AUDIO,\n  SET_AUDIO, SETTED_AUDIO,\n  AUDIO_RESET\n} from './actions';\nimport { combineReducers } from 'redux';\nimport _ from 'lodash';\n\nconst items = (state = [], action) => {\n  switch(action.type) {\n    case AUDIO_RESET:\n      return [];\n    case REQUEST_AUDIO:\n      return state;\n    case RECEIVE_AUDIO:\n      return _.unionBy(action.list, state, 'id') // evita doppioni\n    default:\n      return state;\n  }\n}\n\nconst reference = (state = [], action) => {\n  switch(action.type) {\n    case SET_AUDIO:\n      return state;\n    case SETTED_AUDIO:\n      return action.reference\n    default:\n      return state;\n  }\n}\n\nconst isSetting = (state = 0, action) => {\n  switch(action.type) {\n    case SET_AUDIO:\n      return state+1;\n    case SETTED_AUDIO:\n      return state-1;\n    default:\n      return state;\n  }\n}\n\nexport const getAudioList = (state) => state.items;\nexport const getReference = (state) => state.reference;\nexport const isSettingReference = (state) => state.isSetting;\n\nexport default combineReducers({\n  items,\n  reference,\n  isSetting\n})","import 'whatwg-fetch';\nimport config from '../../config/config';\n\nexport const REQUEST_CATEGORY = 'REQUEST_CATEGORY';\nexport const RECEIVE_CATEGORY = 'RECEIVE_CATEGORY';\n\nconst receive_category = (posts) => {\n  return {\n    type:RECEIVE_CATEGORY,\n    posts\n  }\n}\nexport const fetchCategory = (params={}) => (dispatch) => {\n  dispatch({type: REQUEST_CATEGORY})\n\n  return fetch(config.API_MENU_URL + 'category?category_slug=' + params.categorySlug)\n    .then( response => response.json() )\n    .then( json => dispatch(receive_category(json)))\n    .catch( error => receive_category([]))\n}","import { combineReducers } from 'redux';\nimport { REQUEST_CATEGORY, RECEIVE_CATEGORY } from './actions';\n\nconst posts = (state=[], action) => {\n  switch(action.type) {\n    case RECEIVE_CATEGORY:\n      return action.posts;\n    case REQUEST_CATEGORY:\n    default:\n      return state;\n  }\n}\n\nexport const getCategoryPosts = (category) => category.posts\n\nexport default combineReducers({\n  posts,\n})","import 'whatwg-fetch';\nimport config from '../../config/config';\n\nexport const REQUEST_MEANING = 'REQUEST_MEANING';\nexport const RECEIVE_MEANING = 'RECEIVE_MEANING';\n\nconst receive_meaning = (meaning) => {\n  return {\n    type: RECEIVE_MEANING,\n    meaning\n  }\n}\n\nexport const fetchMeaning = (params = {}) => dispatch => {\n\n  dispatch({type:REQUEST_MEANING});\n\n  fetch(\n    config.API_DICTIONARY_URL + 'meaning?word=' + params.word || '',\n    {\n      header: { 'Autorization': 'Bearer ' + config.token }      \n    }\n  )\n    .then( result => result.json() )\n    .then( json => dispatch(receive_meaning(json)))\n    .catch( error => dispatch(receive_meaning({})))\n}\n\nexport const REQUEST_TRADUCTION = 'REQUEST_TRADUCTION';\nexport const RECEIVE_TRADUCTION = 'RECEIVE_TRADUCTION';\n\nconst receive_traduction = (traduction) => {\n  return {\n    type:RECEIVE_TRADUCTION,\n    traduction\n  }\n}\n\nexport const fetchTraduction = (params={}) => (dispatch) => {\n  dispatch({type:REQUEST_TRADUCTION})\n\n  fetch(\n    config.API_DICTIONARY_URL + 'traduction?word=' + params.word || '',\n    {\n      header: { 'Autorization': 'Bearer ' + config.token }      \n    }\n  )\n    .then( result => result.json() )\n    .then( json => dispatch(receive_traduction(json)))\n    .catch( error => dispatch(receive_traduction({})))\n}","import { combineReducers } from 'redux';\nimport {\n  REQUEST_MEANING, RECEIVE_MEANING,\n  REQUEST_TRADUCTION, RECEIVE_TRADUCTION\n}\nfrom './actions';\nimport _ from 'lodash';\n\nconst meaning = (state={}, action) => {\n  switch(action.type) {\n    case RECEIVE_MEANING:\n      return action.meaning;\n    case REQUEST_MEANING:\n    default: return state;\n  }\n}\n\nconst traduction = (state={}, action) => {\n  switch(action.type) {\n    case RECEIVE_TRADUCTION:\n      return action.traduction;\n    case REQUEST_TRADUCTION:\n    default: return state;\n  }\n}\n\nconst isFetchingMeaning = (state=0, action) => {\n  switch(action.type) {\n    case REQUEST_MEANING:\n      return state+1;\n    case RECEIVE_MEANING:\n      return state-1;\n    default: return state;\n  }\n}\n\nconst isFetchingTraduction = (state=0, action) => {\n  switch(action.type) {\n    case REQUEST_TRADUCTION:\n      return state+1;\n    case RECEIVE_TRADUCTION:\n      return state-1;\n    default: return state;\n  }\n}\n\nexport const getMeaning = (state) => state.meaning;\nexport const getTraduction = (state) => state.traduction;\nexport const fetchingMeaning = (state) => state.isFetchingMeaning;\nexport const fetchingTraduction = (state) => state.isFetchingTraduction;\n\nexport default combineReducers({\n  meaning,\n  traduction,\n  isFetchingMeaning,\n  isFetchingTraduction\n})\n","import { createStore, applyMiddleware } from 'redux';\nimport { persistCombineReducers, persistReducer, persistStore } from 'redux-persist';\nimport storage from 'redux-persist/lib/storage'; // defaults to localStorage for web\nimport { reducer as toastr } from 'react-redux-toastr';\nimport thunk from 'redux-thunk';\n// import logger from 'redux-logger';\n\nimport { createBrowserHistory } from \"history\";\nimport { routerMiddleware } from 'react-router-redux';\n\nimport config from './config/config';\nimport posts from './views/Editor/reducer';\nimport reader from './views/Reader/reducer';\nimport audio from './components/Audio/reducer';\nimport category from './components/Menu/reducer';\nimport dictionary from './components/Dictionary/reducer';\n\n/*\nimport reviews from './components/Reviews/reducer';\nimport search from './views/Search/reducer';\nimport navbar from './components/NavBar/reducer';\n*/\nconst rootPersistConfig = {\n  key: 'root',\n  storage,\n  blacklist: [/*\n    'navbar',\n    'search',\n    'toastr',\n    'reviews',\n    */\n    'posts',\n    'audio',\n    'reader',\n    'category',\n    'dictionary'\n  ],\n  debug: true\n};\n\n\nconst rootReducer = persistCombineReducers(rootPersistConfig, {\n  posts: persistReducer(\n    {\n      key: 'posts',\n      storage,\n      blacklist: config.OFFLINE ? ['isFetching', 'hasMore'] : ['isFetching', 'hasMore', 'items'],\n    },\n    posts,\n  ),\n  reader: persistReducer(\n    {\n      key: 'reader',\n      storage,\n      blacklist: config.OFFLINE ? ['isFetching', 'hasMore'] : ['isFetching', 'hasMore', 'items'],\n    },\n    reader,\n  ),\n  audio: persistReducer(\n    {\n      key: 'audio',\n      storage,\n      blacklist: config.OFFLINE ? ['isFetching', 'hasMore'] : ['isSetting'],\n    },\n    audio,\n  ),\n  category: persistReducer(\n    {\n      key: 'category',\n      storage,\n      blacklist: config.OFFLINE ? ['isFetching', 'hasMore'] : ['isSetting'],\n    },\n    category,\n  ),\n  dictionary: persistReducer(\n    {\n      key: 'dictionary',\n      storage,\n      blacklist: config.OFFLINE ? ['isFetching', 'hasMore'] : ['isSetting'],\n    },\n    dictionary,\n  ), \n});\n\n\nconst history = createBrowserHistory();\n\nconst store = createStore(\n  rootReducer,\n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__(),\n  undefined,\n  applyMiddleware(thunk, routerMiddleware(history)),\n);\n\npersistStore(store);\n\nexport { history };\nexport default store;\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { Nav, Navbar, Icon, Dropdown, Sidenav, Divider } from 'rsuite';\n//import  DropdownCategories from './DropdownCategories';\nimport { connect } from 'react-redux';\nimport { bindActionsCreator } from 'redux';\nimport { Link } from 'react-router-dom';\nimport { fetchCategory } from './actions';\nimport { getCategoryPosts } from './reducer';\nimport config from '../../config/config';\nimport _ from 'lodash';\n\nimport './style.css'\n\nclass Navigation extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = { parentWidth: 2000, expanded: false, activeKey: null }\n\n    this.handleExpandSide = this.handleExpandSide.bind(this);\n    this.handleSelect = this.handleSelect.bind(this);\n  }\n\n  componentDidMount() {\n    this.setState({ parentWidth: ReactDOM.findDOMNode(this).parentNode.clientWidth })\n\n    var that = this\n    const debouncedHandleResize = debounce(function handleResize() {\n      that.setState({ 'parentWidth': ReactDOM.findDOMNode(that).parentNode.clientWidth })\n    }, 300)\n\n    window.addEventListener('resize', debouncedHandleResize)\n\n    const { dispatch } = this.props\n    fetchCategory({categorySlug:'treasure-island'})(dispatch)\n\n  }\n\n  handleExpandSide(){\n    this.setState({expanded: !this.state.expanded})\n  }\n  handleSelect(activeKey){\n    this.setState({activeKey: String(activeKey)})\n  }\n\n  render() {\n\n    const { posts } = this.props;\n    const { expanded } = this.state;\n\n    if (this.state.parentWidth < window.viewPorts.sm) {\n      return (\n        <Sidenav\n          appearance='inverse'\n          expanded={expanded} \n          className={ expanded ? ''  : 'sidenav-compact' }\n          defaultOpenKeys={[]}\n          activeKey={this.state.activeKey}\n          onSelect={this.handleSelect}\n        >\n          <Sidenav.Body>\n            <Navbar.Body>\n              <Nav onSelect={this.props.onSelect} activeKey={this.props.activeKey}>\n                <Nav.Item onClick={this.handleExpandSide}\n                  eventKey=\"1\" \n                  style={{height: 56}}\n                  icon={<Icon icon=\"bars\" size='lg' />}\n                  componentClass='span'>\n                  <Link to={'/'}></Link>\n                </Nav.Item>\n                <Dropdown title=\"Altro\" eventKey='a'>\n                  <Dropdown.Item eventKey=\"4\">\n                    <a href='/company/'>Company</a>\n                  </Dropdown.Item>\n                  <Dropdown.Item eventKey=\"5\"><Link to={'/'}>Team</Link></Dropdown.Item>\n                  <Dropdown.Item eventKey=\"6\"><Link to={'/'}>Contact</Link></Dropdown.Item>\n                </Dropdown>\n                <Divider/>\n              </Nav>\n            </Navbar.Body>\n          </Sidenav.Body>\n        </Sidenav>\n      )\n    }\n    else\n      return (\n        <Navbar {...this.props} className='main-nav'>\n          <Navbar.Header>\n            <a href=\"/\" className=\"navbar-brand logo\">\n              <Icon icon='anchor'/>\n            </a>\n          </Navbar.Header>\n          <Navbar.Body>\n            <Nav onSelect={this.props.onSelect} activeKey={this.props.activeKey}>\n              <Nav.Item \n                eventKey=\"1\"\n                componentClass='span' icon={<Icon icon=\"home\" />}>\n                <Link to={'/'}>Home</Link>\n              </Nav.Item>\n\n              {DropdownCategory('Treasure Island', posts, config.isAdmin)}\n              \n              {/*\n              <Dropdown title=\"Altro\">\n                <Dropdown.Item eventKey=\"4\">\n                  <a href='/company/'>Company</a>\n                </Dropdown.Item>\n                <Dropdown.Item eventKey=\"5\">Team</Dropdown.Item>\n                <Dropdown.Item eventKey=\"6\">Contact</Dropdown.Item>\n              </Dropdown>\n            */}\n            </Nav>\n          </Navbar.Body>\n        </Navbar>\n      );\n  }\n\n};\n\nfunction getPost(posts, cap, lang) {\n  let p = null;\n  _.forEach(posts, post => {\n    if( \n      _.find(post.tags, tag => tag.name === lang) && \n      _.find(post.tags, tag => tag.name === cap)) {\n      p = post;\n    }\n  })\n  return p;\n}\n\nconst DropdownCategory = (title, posts, isAdmin) => {\n\n  if(_.isEmpty(posts)) return null;\n\n  let list = [];\n  let descriptionList = []\n  _.forEach(posts, (post, key) => {\n    if( _.find(post.tags, tag => tag.name === 'eng') ) {\n      const cap = _.find(post.tags, tag => tag.name.split('-')[0] === 'chapter' )\n      const engPost = post;\n      const itaPost = getPost(posts, cap.name, 'ita');\n      //list[cap.name] = {'eng': engPost, 'ita': itaPost }\n      const subCategoryName = post.sub_category.name;\n      if(list[subCategoryName] === undefined) {\n        list[subCategoryName] = [];\n        descriptionList[subCategoryName] = []\n      }\n      list[subCategoryName].push(\n        <Dropdown.Item key={key}>\n          <div style={{display:'flex'}}>\n            <Link to={\"/reader/\"+engPost.ID+'/'+itaPost.ID}>\n              {engPost.post_title.split(' ')[1]} - {engPost.chapter}\n            </Link>\n            { isAdmin ? <Link to={\"/editor/\"+engPost.ID}>EDIT</Link> : null }\n            <Divider />\n          </div>\n        </Dropdown.Item>\n      )\n      descriptionList[subCategoryName] = post.sub_category.description;\n    }\n\n  })  \n  let parts = [];\n  for(let partName in list) {\n    parts.push(\n      <Dropdown.Menu key={partName} title={partName + ' - '  + descriptionList[partName]}>\n        {_.reverse(list[partName])}\n      </Dropdown.Menu>\n    )\n    parts.push(<Dropdown.Item divider/>)\n  }\n  _.reverse(parts);\n  return (\n    <Dropdown title={title}>\n      {parts}\n    </Dropdown>\n  )\n}\n\nconst mapStateToProps = (state) => {\n  return { posts: state.category.posts }\n}\n\nconst mapDispatchToProps = dispatch => {\n  return Object.assign({ dispatch })\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Navigation)\n\n\nfunction debounce(fn, ms) {\n  let timer\n  return _ => {\n    clearTimeout(timer)\n    timer = setTimeout(_ => {\n      timer = null\n      fn.apply(this, arguments)\n    }, ms)\n  };\n}\n","import './App.css';\nimport './main.style'\n\nimport { Button, Container, Header, Content, Footer, FlexboxGrid, Col } from 'rsuite';\nimport Menu from './components/Menu'\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router';\nimport config  from './config/config';\nimport _ from 'lodash';\n\n//import { isMenuVisible } from './components/NavBar/reducer';\n//import { closeMenu } from './components/NavBar/actions';\n//import NavBar from './components/NavBar';\n//import SideMenu from './views/SideMenu';\n\n\n\nwindow.viewPorts = {\n  xs: 0, \n  sm: 480, // <=\n  md: 960, // <=\n  lg: 1200 // <=\n}\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.handleSelect = this.handleSelect.bind(this);\n    this.state = {\n      activeKey: null,\n      loading: false,\n    };\n  }\n  handleSelect(eventKey) {\n    this.setState({\n      activeKey: eventKey\n    });\n  }\n  render() {\n    const { activeKey } = this.state;\n\n    // Wait for a login with demo account\n    if(config.token === undefined) {\n      _.delay((state) => this.setState(state), 1000, {loading:!this.state.loading})\n      return <div>Loading... {this.state.loading}</div>\n    }\n\n    return (\n      <Container className=\"App\">\n        <div className='view-port'>\n          <Header className='header-container'>\n            <Menu appearance='inverse' onSelect={this.handleSelect} activeKey={activeKey}/>\n          </Header>\n          <FlexboxGrid justify='center'>\n            <FlexboxGrid.Item componentClass={Col} xs={24} sm={24} lg={20} xl={15} className='main-container'>\n              <Content>{this.props.children}</Content>\n            </FlexboxGrid.Item>\n          </FlexboxGrid>\n        </div>\n        <Footer className='footer-container'>Treasure Island by Robert Louis Stevenson</Footer>\n      </Container>\n    );\n  }\n}\n\n\n/*\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.hideSidebar = this.hideSidebar.bind(this);\n  }\n\n  hideSidebar() {\n    if (this.props.sideMenuVisible) {\n      this.props.closeMenu();\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        <ReduxToastr\n          timeOut={4000}\n          newestOnTop\n          preventDuplicates\n          position=\"top-center\"\n          transitionIn=\"fadeIn\"\n          transitionOut=\"fadeOut\"\n        />\n        <Sidebar.Pushable>\n          <SideMenu isVisible={this.props.sideMenuVisible} closeMenu={this.props.closeMenu} />\n          <Sidebar.Pusher dimmed={this.props.sideMenuVisible} onClick={this.hideSidebar}>\n            <NavBar />\n            {this.props.children}\n          </Sidebar.Pusher>\n        </Sidebar.Pushable>\n      </div>\n    );\n  }\n}\n*/\nApp.propTypes = {\n  sideMenuVisible: PropTypes.bool.isRequired,\n  closeMenu: PropTypes.func.isRequired,\n  children: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.node), PropTypes.node]),\n};\n\nApp.defaultProps = {\n  children: null,\n};\n\nconst mapStateToProps = state => ({\n  //sideMenuVisible: isMenuVisible(state.navbar),\n});\n\nexport default withRouter(\n  connect(\n    mapStateToProps,\n    { /*closeMenu*/ },\n  )(App),\n);","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { Link, Redirect } from 'react-router-dom';\nimport { Panel, Divider, List, FlexboxGrid, Col } from 'rsuite';\nimport config from '../../config/config';\nimport _ from 'lodash';\nimport './style.css';\n\nclass Home extends React.Component{\n\n  constructor(props){\n    super(props)\n    this.state = { posts: null }\n  }\n\n  render()\n  {\n    const { posts } = this.props;\n\n    return(\n      <FlexboxGrid>\n        <FlexboxGrid.Item componentClass={Col} lg={4} xl={5}/>\n        <FlexboxGrid.Item componentClass={Col} lg={16} xl={14}>\n          <Panel>\n            <div style={{textAlign:'center'}}>\n              <h1>Treasure Island</h1>\n              <h3>Martin Louis Stevenson</h3>\n              <figure>\n                <img\n                  style={{height:'500px', borderRadius:'5px'}}\n                  src='https://images.unsplash.com/photo-1564845654222-d437f029c5c4?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1351&q=80'\n                  alt='Alfonso Reyes - boat'\n                />\n                <figcaption>Image from unsplash by Alonso Reyes</figcaption>\n              </figure>\n              <hr/>\n              <p>Audio-libro bilingue Inglese-Italiano con supporto dizionario (Oxford)</p>\n              <p>Letto da: Mark F. Smith, audio completo su <a href='https://www.youtube.com/watch?v=PuiDkBO_SAY'>Youtube</a></p>\n              <p>Traduzione da: <a href='https://libri.freenfo.net/3/3044030.html'>libri.freenfo.net</a></p>\n              <p>Dev by: Alessio Guerriero</p>\n            </div>\n            <hr/>\n            <h3>Utilizzo</h3>\n              <div\n                dangerouslySetInnerHTML={\n                  {__html:'<iframe width=\"100%\" height=\"600px\" src=\"https://www.youtube.com/embed/UwHFogMirgU\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>'}}\n              />\n            <hr/>\n            <h3>Contents</h3>\n            {DropdownCategory('Treasure Island', posts, config.isAdmin)}\n          </Panel>\n        </FlexboxGrid.Item>\n      </FlexboxGrid>\n    )\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return { posts: state.category.posts }\n}\n\nexport default connect(mapStateToProps, null)(Home);\n\n\nconst DropdownCategory = (title, posts, isAdmin) => {\n\n  if(_.isEmpty(posts)) return null;\n\n  let list = [];\n  let descriptionList = []\n  _.forEach(posts, (post, key) => {\n    if( _.find(post.tags, tag => tag.name === 'eng') ) {\n      const cap = _.find(post.tags, tag => tag.name.split('-')[0] === 'chapter' )\n      const engPost = post;\n      const itaPost = getPost(posts, cap.name, 'ita');\n      //list[cap.name] = {'eng': engPost, 'ita': itaPost }\n      const subCategoryName = post.sub_category.name;\n      if(list[subCategoryName] === undefined) {\n        list[subCategoryName] = [];\n        descriptionList[subCategoryName] = []\n      }\n      list[subCategoryName].push(\n        <List.Item key={key}>\n          <div style={{display:'flex'}}>\n            <Link to={\"/reader/\"+engPost.ID+'/'+itaPost.ID}>\n              {engPost.post_title} - {engPost.chapter} \n            </Link>\n            { isAdmin ? <Link to={\"/editor/\"+engPost.ID}>EDIT</Link> : null }\n          </div>\n        </List.Item>\n      )\n      descriptionList[subCategoryName] = post.sub_category.description;\n    }\n\n  })\n\n  let parts = [];\n  for(let partName in list) {\n    parts.push(\n      <Panel header={partName + ' - ' + descriptionList[partName]}>\n        <List key={partName}>\n          {_.reverse(list[partName])}\n        </List>\n      </Panel>\n    )\n  }\n  return (\n    <div id='contents'>\n      {_.reverse(parts)}\n    </div>\n  )\n}\n\nfunction getPost(posts, cap, lang) {\n  let p = null;\n  _.forEach(posts, post => {\n    if( \n      _.find(post.tags, tag => tag.name === lang) && \n      _.find(post.tags, tag => tag.name === cap)) {\n      p = post;\n    }\n  })\n  return p;\n}","import React from 'react';\nimport { connect } from 'react-redux';\nimport { fetchAudioList, setOrUpdateAudio, AUDIO_RESET } from './actions';\nimport { getAudioList, getReference, isSettingReference } from './reducer';\nimport { Panel, Notification } from 'rsuite';\nimport _ from 'lodash';\nimport './style.css';\n\nclass AudioList extends React.Component {\n\n  constructor(props){\n    super(props)\n\n    this.list = []\n    this.currentPlay = ''\n    this.currentPlayIndex = this.firstIndex = 0\n    this.lastActionTime = Date.now();\n    this.prevAction = '';\n    this.reference = '';\n    this.selectAudio = this.selectAudio.bind(this);\n  }\n\n  componentDidMount(){\n    const { dispatch, postId } = this.props;\n    fetchAudioList({postId})(dispatch);\n  }\n\n  componentDidUpdate(prevProps, prevState){\n\n    if(!_.isEmpty(this.list)) {\n      if(_.isEmpty(this.currentPlay)) {\n        // first run\n        this.currentPlayIndex = this.firstIndex = Number(Object.keys(this.list)[0])\n        this.currentPlay = this.getAudioId(this.currentPlayIndex)\n      }\n    }\n    const { reference, isSettingReference } = this.props\n    if( !isSettingReference ) {\n\n      if( this.reference !== '' ) {\n        if( reference === this.reference ) {\n          console.log('Update reference ok ' + reference)\n        }\n        else {\n          console.log('error update reference: ' + this.reference + ' - ' + reference)\n        }\n        this.reference = '';\n      }\n    }\n  }\n\n  getAudioId(index){\n    return 'audio-'+this.list[index].id\n  }\n  isPlaying(id){\n    return 'audio-'+id === this.currentPlay;\n  }\n  isPlaylistEnded(){\n    return this.list.length === this.currentPlayIndex+1\n  }\n\n  play(){\n    if(!_.isEmpty(this.currentPlay)) {\n      document.getElementById(this.currentPlay).play()  \n    }\n    else{\n      alert('Playlist vuota!');\n    }\n  }\n\n  getIdFromFilename(name){\n    return Number(name.split('-')[1].split('.')[0]);\n  }\n\n  nextTrack(){\n    if(!this.isPlaylistEnded()) {\n      this.previousPlay = this.currentPlay;\n      this.currentPlay = this.getAudioId(++this.currentPlayIndex);\n    }\n    else {\n      alert('Playlist ended!')\n    }    \n  }\n\n  prevTrack(){\n    if( this.currentPlayIndex === this.firstIndex ) return\n    this.currentPlay = this.getAudioId(--this.currentPlayIndex);\n    //this.previousPlay = this.getAudioId(this.currentPlayIndex>this.firstIndex ? this.currentPlayIndex-1 : this.firstIndex)\n  }\n\n  selectAudio(item){\n    const id = this.getIdFromFilename(item.name)\n    this.currentPlayIndex = id;\n    this.currentPlay = this.getAudioId(id);\n    this.setState({refresh:''})\n    this.props.handleSelect(item.reference)\n  }\n\n  render(){\n    const { audioList, postId, selected, dispatch, isSettingReference } = this.props;\n    let action = this.props.action;\n\n    let componentList = null;\n    if(!_.isEmpty(audioList)) {\n\n      if((Date.now() - this.lastActionTime ) > 200 && // ms\n        this.prevAction !== this.props.action) {\n\n        console.log('action: ' + this.props.action + ' ---- pre:' + this.prevAction)\n        this.prevAction = this.props.action;\n        this.lastActionTime = Date.now();\n        switch(this.props.action) {\n          case 'play':\n            this.play();\n            break;\n          case 'prev':\n            this.prevTrack();\n            break;\n          case 'next':\n            this.nextTrack();\n            break;\n          case 'refresh-audio-list':\n            Notification['info']({title:'refresh audio list'})\n            const { dispatch, postId, showAlsoUnassigned } = this.props;\n            dispatch({type: AUDIO_RESET})\n            fetchAudioList({postId})(dispatch);\n            break;\n        }\n      } \n\n      const list = _.filter(audioList, audio => audio.post_parent == postId || audio.post_parent == 0 )\n\n      let playingNameId = 0;\n      _.forEach( list, (item) => { \n        // use the id in the filename for correct asc order\n        const index = this.getIdFromFilename(item.name);\n\n        if(this.isPlaying(item.id) ) {\n          playingNameId = index\n        } \n\n        if(action === 'insert' && this.isPlaying(item.id) ) {\n          this.reference = `${postId}-${selected}`\n          item = _.assign(item, { reference: this.reference })\n          this.list[index] = item;\n\n          if( !isSettingReference ){\n            setOrUpdateAudio({\n              id: item.id,\n              reference: this.reference,\n              post_parent: postId\n            })(dispatch)\n            action = '';\n          }\n        }\n        else {\n          if( _.isUndefined(this.list[index]) ) {\n            this.list[index] = item;\n          }\n        }\n      })\n\n      componentList = this.list.map(item => {\n        let fileNameId = this.getIdFromFilename(item.name);\n        return <Audio \n          item={item}\n          hide={ ( fileNameId < playingNameId-5 ) ? true : false }\n          active={this.isPlaying(item.id)}\n          handleClick={this.selectAudio}\n        />\n        }\n      )\n    }\n    return (<Panel className='right-panel'>{componentList || null}</Panel>);\n  }\n}\n\nclass Audio extends React.Component {\n\n  render(){\n    const { item, active, hide } = this.props;\n    return (\n      <div \n        key={item.id}\n        id={item.id}\n        className={\n          'audio-container ' + \n          ( active ? 'selected ' : '') +\n          ( hide ? 'hidden' : '')\n        }\n        onClick={ () => {this.props.handleClick(item)} }\n      >\n        {item.name.split('.')[0]}\n        { !_.isEmpty(item.reference) ? (' - ' + item.reference ) : '' }\n        <audio controls id={'audio-'+item.id}>\n          <source src={item.source} type=\"audio/mpeg\"></source>\n        </audio>\n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    audioList: getAudioList(state.audio),\n    reference: getReference(state.audio),\n    isSettingReference: isSettingReference(state.audio)\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return Object.assign({}, {dispatch});\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AudioList);","import React from 'react';\nimport { connect } from 'react-redux';\nimport { fetchPost } from './actions';\nimport { getPosts } from './reducer';\nimport { Panel, FlexboxGrid, Col, Button, Sidenav, Notification, Toggle } from 'rsuite';\nimport _ from 'lodash';\nimport AudioList from '../../components/Audio';\n//import $ from 'jquery';\n\nimport './style.css';\n\nclass Selectors extends React.Component {\n\n  constructor(props){\n    super(props);\n  }\n\n  render(){\n    const { selected, data, counter } = this.props;\n    let subCounter = 0;\n    return _.map(data.split(' '), data => {\n      subCounter++;\n      let id = counter + '-' + subCounter;\n      let classes = 'piece';\n      if(id === selected){\n        classes = 'piece selected';\n      }\n      return( \n        <span \n          id={id} \n          onClick={this.props.handleSelect} \n          className={classes} \n          dangerouslySetInnerHTML={{__html: '&nbsp;'+data}}/>\n        )\n    })\n  }\n}\n\nclass Editor extends React.Component {\n\n  constructor(props){\n    super(props);\n    this.postId = this.props.match.params.post\n\n    this.state = {\n      selected: 0,\n      audioSelected: 0,\n      action: '',\n      canAttach:false,\n      allAudio:false,\n      actionList: [],\n    }\n    this.oldSelected = this.state.selected;\n    this.handleSelect = this.handleSelect.bind(this);\n    this.handleSelectAudio = this.handleSelectAudio.bind(this);\n  }\n\n  componentDidMount(){\n    const { dispatch } = this.props\n    fetchPost({\n      postId: this.postId\n    })(dispatch)\n  }\n\n  refresh(){\n    this.componentDidMount()\n    this.trigger('refresh-audio-list')\n    this.setState({})\n  }\n\n  componentDidUpdate(prevProps, prevState){\n    this.oldSelected = this.state.selected;\n\n    if(!_.isEmpty(this.state.actionList)) { // execute actions 'insert' - 'next' and 'play'\n      let actionList = this.state.actionList;\n      if(this.state.action !== actionList[actionList.length-1]) {\n        const action = actionList.pop();\n        _.delay(this.setState.bind(this), 100, {action: action})\n      }\n    }\n  }\n\n  handleSelect(e){\n    this.setState({selected: e.currentTarget.id});\n  }\n\n  handleSelectAudio(selected){\n    // remove post_id from selection\n    const split = selected.split('-');\n    selected = `${split[1]}-${split[2]}`\n    this.oldSelected = selected; // evita avanzamento\n    this.setState({selected, action: ''})\n  }\n\n  selectionChanged(){\n    return this.oldSelected !== this.state.selected\n  }\n\n  insertNextNplay(){\n    if(this.state.canAttach === false) {\n      Notification['info']({title: 'Abilitare inserimento'})\n      return ''\n    }\n\n    let actionList = [];\n    actionList.push('play');\n    actionList.push('next');\n    actionList.push('insert');\n    this.setState({actionList, 'action': ''}); // importante per evitare, al refresh \n                                               // che l'azione venga ripetuta\n    return '';\n  }\n\n  trigger(action){\n    this.setState({action: action})\n  }\n\n  render(){\n\n    let post = this.props.posts.find( post => post.id === Number(this.postId) )\n    const { selected, action } = this.state;\n    if(!_.isNil(post)) {\n      let content = post.content.rendered.split('<p>')\n      content = _.filter(content, data => !_.isEmpty(_.replace(data, /\\n/, '')) )\n      content = _.map( content, data => _.replace(data, '</p>', ''))\n      let counter = 0;\n      content = _.map(content, data => {\n        counter++;\n        return <p><Selectors selected={selected} counter={counter} handleSelect={this.handleSelect} data={data}/></p>\n      })\n      return (\n        <FlexboxGrid>\n          <Panel className='player-editor'>\n            <Button onClick={ () => this.trigger('play') }>Play</Button>\n            <Button onClick={ () => this.trigger('next') }>Next</Button>\n            <Button onClick={ () => this.trigger('prev') }>Prev</Button>\n            <Button onClick={ () => this.refresh() }>Reset audio</Button>\n            <Button \n              color={this.state.canAttach ? 'green' : 'red'}\n              onClick={ () => this.setState({canAttach:!this.state.canAttach}) }>\n              Inserimento - {this.state.canAttach ? 'Attivo' : 'Disattivo'}\n            </Button>\n            <div style={{display:'flex', flexDirection:'column'}}>\n              All audio files \n              <Toggle onChange={ () => { \n                this.setState({allAudio:!this.state.allAudio});\n                this.refresh();\n              }}/>\n            </div>\n          </Panel>\n          <FlexboxGrid.Item className='text-container' componentClass={Col} xs={24} sm={24} lg={20} xl={22}>\n            <Panel>\n              {content}\n            </Panel>\n          </FlexboxGrid.Item>\n          <FlexboxGrid.Item className={'fixed'} componentClass={Col} xs={24} sm={24} lg={4} xl={2}>\n            <AudioList\n              postId={this.postId}\n              action={ this.selectionChanged() ? this.insertNextNplay() : action}\n              selected={this.state.selected} \n              handleSelect={this.handleSelectAudio}\n            />\n              {/*showAlsoUnassigned={true || this.state.allAudio}*/}\n          </FlexboxGrid.Item>\n        </FlexboxGrid>\n      )\n    }\n    else {\n      return <div></div>;\n    }\n  }\n\n}\n\n\nconst mapDispatchToProps = (dispatch) => {\n  return Object.assign({}, {dispatch})\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    posts: getPosts(state.posts)\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Editor);","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { fetchMeaning, fetchTraduction } from './actions';\nimport { getMeaning, getTraduction, fetchingMeaning, fetchingTraduction } from './reducer';\nimport { Notification, Drawer, Loader, List, Divider } from 'rsuite';\nimport _ from 'lodash';\n\nimport './style.css';\n\nclass Dictionary extends Component {\n\n  constructor(props){\n    super(props);\n    this.state = {};\n  }\n\n  close(){\n    this.props.close() // call parent hook for close drawer\n  }\n\n  componentDidUpdate(prevProps, prevState){\n    if (prevProps.show === false && this.props.show && this.props.word !== '') {\n      const { word, dispatch } = this.props;\n      fetchMeaning({word})(dispatch);\n      fetchTraduction({word})(dispatch);\n    }\n  }\n\n  render(){\n\n    const { meaning, traduction } = this.props;\n\n    return (\n      <Drawer\n        show={this.props.show}\n        onHide={this.close.bind(this)}\n      >\n        <Drawer.Header>\n          <Drawer.Title><b>Word: \"{this.props.word}\"</b></Drawer.Title>\n        </Drawer.Header>\n          <Drawer.Body>\n            { this.props.fetchingMeaning \n              ? \n              <Loader size='md' content='Loading definitions and sounds'></Loader> \n              : \n              <div>\n                <Divider><b>Definitions list</b></Divider>\n                <DefinitionList def={meaning.def}/>\n                <Divider><b>Sounds</b></Divider>\n                <AudioWord lang='English' src={meaning.uk}/>\n                <AudioWord lang='United States' src={meaning.us}/>\n              </div>\n            }\n            { this.props.fetchingTraduction \n              ?\n              <Loader size='md' content='Loading Traduction'></Loader> \n              :\n              <div>\n                <Divider><b>Traduction</b></Divider>\n                <List hover id='traductions'>\n                  {_.map(traduction, (ele, i) => <List.Item>{i+1}. {ele}</List.Item>)}\n                </List>\n              </div>\n            }\n          </Drawer.Body>\n        }\n        <Drawer.Footer>\n        </Drawer.Footer>\n      </Drawer>\n    )\n\n  }\n}\n\nfunction DefinitionList(props) {\n  let list = [];\n\n  let index = 1;\n  _.forEach(props.def, (def, i) => \n    list.push(<List.Item key={i}>{(index++) + '. ' + def.replace(':','')}.</List.Item>)\n  );\n  return <List id='definitions-list' hover>{list}</List>\n}\n\nfunction AudioWord(props){\n\n  if (!_.isEmpty(props.src)) {\n    return (\n      <div>{props.lang}\n        <audio controls style={{width:'100%'}}>\n          <source src={props.src} type=\"audio/mpeg\"></source>\n        </audio>\n      </div>\n    )\n  }\n  else return null;\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    meaning: getMeaning(state.dictionary),\n    fetchingMeaning: fetchingMeaning(state.dictionary),\n    fetchingTraduction: fetchingTraduction(state.dictionary),\n    traduction: getTraduction(state.dictionary),\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return Object.assign({}, {dispatch});\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Dictionary);","import React from 'react';\nimport { connect } from 'react-redux';\nimport { fetchPost, fetchReferences } from './actions';\nimport { getPosts, getReferences, isFetching } from './reducer';\nimport { \n  Panel, FlexboxGrid, Col, Sidenav, Notification, Toggle, Divider,\n  ButtonToolbar, Button, IconButton, Icon\n  } from 'rsuite';\nimport _ from 'lodash';\nimport { Howl, Howler } from 'howler';\nimport Dictionary from '../../components/Dictionary';\n//import $ from 'jquery';\nimport { StickyContainer, Sticky } from 'react-sticky';\n\nimport './style.css';\n\nclass Selectors extends React.Component {\n\n  constructor(props){\n    super(props);\n  }\n\n  render(){\n    const { data, counter } = this.props;\n    let subCounter = 0;\n    return _.map(data.split(' '), data => {\n      subCounter++;\n      let id = counter + '-' + subCounter;\n      let classes = 'piece';\n      return( \n        <span \n          key={subCounter}\n          id={id} \n          onClick={this.props.handleSelect} \n          className={classes} \n          dangerouslySetInnerHTML={{__html: '&nbsp;'+data}}/>\n        )\n    })\n  }\n}\n\nclass Reader extends React.Component {\n\n  constructor(props){\n    super(props);\n    const postIta = props.match.params.postIta;\n    const postEng = props.match.params.postEng;\n\n    this.state = {\n      selected: '',          // without post_id   'N-N'\n      selectedReference: '', // with post_id    'N-N-N'\n      selectedPiece:'',      // for word selection\n      audioSelected: 0,\n      action: '',\n      play: false,\n      isPlaying: false,\n      postEng: postEng,\n      postIta: postIta,\n      wordSelected: '',       // word for traduction\n      showTraduction: false,  // show Drawer traduction\n      playOnClick: true,      // Play selection on click if active\n\n    }\n    this.oldSelected = this.state.selected;\n    this.handleSelect = this.handleSelect.bind(this);\n    this.play = this.play.bind(this);\n    this.playAll = this.playAll.bind(this);\n    this.playIndex = 0;\n    this.hideTraduction = this.hideTraduction.bind(this);\n\n    this.fetchData()\n    //Notification['info']({title:'construct'})\n  }\n\n  fetchData(){\n    const { dispatch } = this.props;\n    const { postIta, postEng } = this.state\n    fetchPost({\n      postId: postEng\n    })(dispatch)\n    fetchPost({\n      postId: postIta\n    })(dispatch)\n\n    fetchReferences({\n      postId: postEng\n    })(dispatch)\n  }\n\n  componentDidMount(){\n    //Notification['info']({title:'mounted'})\n    _.delay(() => {\n      window.scroll({\n        top: 0,\n        left: 0,\n        behavior: 'smooth'\n      });\n    },1000);\n  }\n\n  getSelectionId(reference){\n    let split = reference.split('-');\n    return `${split[1]}-${split[2]}`; // toglie post_id\n  }\n\n  insertReferencesIntoText(references){\n    if(_.isUndefined(this.referencesInserted)){\n      this.referencesInserted = true\n    }\n    else {\n      return\n    }\n\n    _.forEach(references, item => {\n      let id = this.getSelectionId(item.reference)\n      document.getElementById(id).classList.add('selectable');\n    })\n    Notification['info']({title:'References inserted'})\n  }\n\n  alignText(){\n    if(_.isUndefined(this.textAligned)){\n      this.textAligned = true\n    }\n    else {\n      return\n    }\n\n    const itaP = document.querySelectorAll('#ita p');\n    _.forEach(document.querySelectorAll('#eng p'), ( val, key ) => {\n      if(!_.isUndefined(itaP[key])) {\n        itaP[key].style.position = 'absolute';\n        itaP[key].style.top = val.offsetTop+'px';\n      }\n    })\n\n    Notification['info']({title:'Text ready!'})\n  }\n\n  getReferences(){\n    const { referencesList } = this.props;\n    return _.sortBy(referencesList[this.state.postEng], ['name']); // sort necessario dato che alcune\n                                                                   // volte l'ordine tra gli audio attribuiti\n                                                                   // non è crescente.\n  }\n\n  componentDidUpdate(prevProps, prevState){\n\n    const references = this.getReferences()\n    //this.oldSelected = this.state.selected;\n    if( !_.isEmpty(references) && !tooEarly(1000) ) {\n      _.delay(this.insertReferencesIntoText.bind(this), 1500, references)\n      _.delay(this.alignText.bind(this), 1500)\n    }\n\n    if(this.state.play) {\n      this.play();\n      this.setState({play:false})\n    }\n  }\n\n  updateSelection(current){\n    if(this.state.selected !== '') {\n      document.getElementById(this.state.selected).classList.remove('selected');\n    }\n    current.classList.add('selected');\n  }\n\n  onlyWord(word){\n    word = word.replace(/&nbsp;/g, '')\n    return word.replace(/[\".,\\/#!?$%\\^&\\*;:{}=\\-_`~()“”]/g,\"\") // '\n  }\n\n  handleSelect(e){\n    let current = e.currentTarget;\n    this.selectedPiece = current.id;\n\n    if(current.classList.contains('selectable')) {\n      this.updateSelection(current);\n      const reference = `${this.state.postEng}-${current.id}`;\n      this.setState({\n        selected: current.id, \n        selectedReference: reference\n      });\n\n      if(this.state.playOnClick) {\n        this.setState({play:true})\n      }\n    }\n\n    // Select word for dictionary's definitions \n    const word = this.onlyWord(current.innerHTML);\n    if( !this.state.playOnClick ) {\n      Notification['info']({title: 'Word selected for dictionary', description:word});\n    }\n    this.setState({\n      wordSelected: word\n    });\n  }\n\n  play(index=0, onEnd=null) {\n    const { selected, selectedReference } = this.state;\n    const references = this.getReferences()\n\n    if(_.isEmpty(selectedReference)) {\n      Notification['info']({'placement': 'topStart', title:'Need selection first'});\n      return\n    }\n\n    let ref = null;\n    if( index === 0 ) {\n      ref = _.find( references, ( item ) => item.reference === selectedReference );\n    }\n    else {\n      this.playIndex = index;\n      ref = references[index];\n      const selectionId = this.getSelectionId(ref.reference)\n      this.updateSelection(document.getElementById(selectionId))\n      this.setState({\n        selectedReference: ref.reference,\n        selected: selectionId\n      });      \n    }\n\n    let audio = new Howl({\n      src:ref.source,\n      autoplay: true,\n      preload: true\n    })\n\n    audio.on('end', onEnd);\n  }\n\n  playAll() {\n    this.setState({stopPlay: false});\n\n    let index = 0;\n    const handleEnd = () => {      \n      const { selectedReference, stopPlay } = this.state;\n      const references = this.getReferences()\n\n      if( stopPlay ) {\n        return\n      }\n\n      if( index === 0) {\n        index = _.findIndex( references, (item) =>  item.reference === selectedReference)\n      }\n\n      // Skip duplicati\n      // Da evitare in fase di inserimento: TODO\n      while(\n        !_.isUndefined(references[index+1]) && \n        references[index+1].name == references[index].name) {\n        \n        ++index;\n        if(_.isUndefined(references[index+1])) break;\n      }\n      \n      if( !_.isUndefined(references[index+1])) {\n        this.play(++index, handleEnd)\n      }\n      else {\n        Notification['info']({title: 'End of Chapter'})\n      }\n    }\n\n    this.play(0, handleEnd.bind(this));\n  }\n\n  trigger(action){\n    this.setState({action: action})\n    setTimeout(()=> this.setState({action: '' }), 100)\n  }\n\n\n  hideTraduction(){\n    this.setState({showTraduction: false})\n  }\n\n  render(){\n\n    const postEng = this.props.posts.find( post => post.id === Number(this.state.postEng) )\n    const postIta = this.props.posts.find( post => post.id === Number(this.state.postIta) )\n\n    const { selected, action, playOnClick, wordSelected, showTraduction } = this.state;\n\n    if(!_.isNil(postEng) && !_.isNil(postIta)) {\n      //Notification['info']({title:'render'})\n      let engContent = null;\n      let content = postEng.content.rendered.split('<p>')\n      content = _.filter(content, data => !_.isEmpty(_.replace(data, /\\n/, '')) )\n      content = _.map( content, data => _.replace(data, '</p>', ''))\n      let counter = 0;\n      content = _.map(content, data => {\n        counter++;\n        return <p key={counter}><Selectors selected={selected} counter={counter} handleSelect={this.handleSelect} data={data}/></p>\n      })\n\n      let itaContent = postIta.content.rendered;\n\n      return (\n        <StickyContainer>\n        <FlexboxGrid>\n          <FlexboxGrid.Item  componentClass={Col} xs={24} sm={24} lg={24} xl={24}>\n            <Sticky>\n              { ({style}) => \n              <Panel className='player' style={style}>\n                <ButtonToolbar style={{display:'flex', alignItems:'center'}}>\n                  <IconButton \n                    disabled={playOnClick ? true : false}\n                    color='blue'\n                    onClick={ () => this.play() }\n                    icon={<Icon icon='arrow-right'/> }\n                  >Play\n                  </IconButton>\n\n                  <Toggle \n                    size='lg'\n                    checkedChildren='Play on click' \n                    unCheckedChildren='Select word'\n                    checked={playOnClick}\n                    onChange={(checked) => this.setState({playOnClick:checked})}\n                  />\n                  <Divider vertical/>\n\n                  <Button \n                    color='blue'\n                    onClick={ this.playAll }>Play All</Button>\n                  <Button \n                    color='violet'\n                    onClick={ () => this.setState({stopPlay: true}) }>Stop</Button>\n                  <Divider vertical/>\n                  \n                  <Button \n                    color='green'\n                    onClick={ () => this.setState({showTraduction:true}) }>\n                    Dictionary { wordSelected ? `for \"${wordSelected}\"` : null }\n                  </Button>\n\n                  {/*<Button onClick={ () => this.trigger('insert') }>Insert</Button>*/}\n                </ButtonToolbar>\n              </Panel>\n              }\n            </Sticky>\n          </FlexboxGrid.Item>\n          <FlexboxGrid.Item id='eng' className='text-container eng' componentClass={Col} xs={12} sm={12} lg={12} xl={12}>\n            <h2 dangerouslySetInnerHTML={{__html: postEng.title.rendered}}></h2>\n            <Panel>\n              {content}\n            </Panel>\n          </FlexboxGrid.Item>\n          <FlexboxGrid.Item id='ita' className='text-container ita' componentClass={Col} xs={12} sm={12} lg={12} xl={12}>\n            <h2 dangerouslySetInnerHTML={{__html: postIta.title.rendered}}></h2>\n            <Panel>\n              <div dangerouslySetInnerHTML={{__html: itaContent}}/>\n            </Panel>\n          </FlexboxGrid.Item>\n          <Dictionary\n            word={wordSelected}\n            show={showTraduction}\n            close={ this.hideTraduction }\n          />\n        </FlexboxGrid>\n        </StickyContainer>\n      )\n    }\n    else {\n      return <div></div>;\n    }\n  }\n\n}\n\nclass Audio extends React.Component {\n  render(){\n    const { itemId, source } = this.props;\n    return (\n      <audio controls id={itemId}>\n        <source src={source} type=\"audio/mpeg\"></source>\n      </audio>\n    )\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return Object.assign({}, {dispatch})\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    posts: getPosts(state.reader),\n    referencesList: getReferences(state.reader),\n    fetching: isFetching(state.reader)\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Reader);\n\n\n/* for debounce */\nlet lastcall;\nfunction tooEarly(ms=100){\n    lastcall = lastcall || Date.now();\n    const now = Date.now();\n    if(lastcall < now-ms ) {\n      lastcall = now;\n      return true\n    }\n    else { \n      return false\n    }\n  }","import React from 'react';\nimport { Provider } from 'react-redux';\nimport { BrowserRouter as Router, HashRouter , Route, Switch } from 'react-router-dom';\n// Per utilizzare il router senza hash ( vedi google per differenza ) utilizzare\n// BrowserRouter as Router\n// L'HashRouter evita che la richiesta venga inoltrata backend.. come diff\nimport store from './configureStore';\nimport App from './App';\nimport ReactDOM from 'react-dom';\nimport * as serviceWorker from './serviceWorker';\nimport Home from './views/Home';\n// import Product from './views/Product';\n//import Products from './views/Products';\n//import Categories from './views/Categories';\n//import Cart from './views/Cart';\nimport Editor from './views/Editor';\nimport Reader from './views/Reader';\n\n\n/*\nimport Product from './views/Product';\nimport Search from './views/Search';\n\n*/\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <Router>\n        <App>\n          <Switch>\n            <Route exact path=\"/\" component={Home} />\n            <Route path=\"/login\" component={Login} />\n            <Route path=\"/editor/:post\" component={Editor} />\n            <Route path=\"/reader/:postEng/:postIta\" render={ props => <Reader {...props} key={Date.now()}/> } />\n                                                                      {/* For re-mount component when route change */}\n          </Switch>\n        </App>\n      </Router>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n\n\nfunction Login(){\n\n}\n\n"],"sourceRoot":""}